"use strict";(()=>{var e={};e.id=142,e.ids=[142,660],e.modules={8030:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>b,default:()=>x,getServerSideProps:()=>p,getStaticPaths:()=>m,getStaticProps:()=>h,reportWebVitals:()=>j,routeModule:()=>S,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>f,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>g});var l=t(7093),r=t(5244),d=t(1323),i=t(2899),n=t.n(i),c=t(6814),o=t(646),u=e([c,o]);[c,o]=u.then?(await u)():u;let x=(0,d.l)(o,"default"),h=(0,d.l)(o,"getStaticProps"),m=(0,d.l)(o,"getStaticPaths"),p=(0,d.l)(o,"getServerSideProps"),b=(0,d.l)(o,"config"),j=(0,d.l)(o,"reportWebVitals"),g=(0,d.l)(o,"unstable_getStaticProps"),N=(0,d.l)(o,"unstable_getStaticPaths"),y=(0,d.l)(o,"unstable_getStaticParams"),v=(0,d.l)(o,"unstable_getServerProps"),f=(0,d.l)(o,"unstable_getServerSideProps"),S=new l.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/jobs",pathname:"/jobs",bundlePath:"",filename:""},components:{App:c.default,Document:n()},userland:o});a()}catch(e){a(e)}})},7435:(e,s,t)=>{t.d(s,{Z:()=>l});var a=t(997);function l({kind:e="info",message:s,onClose:t}){let l="success"===e?"green":"warning"===e?"yellow":"error"===e?"red":"blue";return(0,a.jsxs)("div",{className:`rounded-md border px-3 py-2 bg-${l}-50 border-${l}-200 text-${l}-800 flex items-start justify-between gap-2`,children:[a.jsx("div",{children:s}),t&&a.jsx("button",{className:`text-${l}-800`,onClick:t,children:"\xd7"})]})}},646:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>x});var l=t(997),r=t(5941),d=t(4985),i=t(5573),n=t(7435),c=t(6689),o=t.n(c),u=e([r,d,i]);function x(){let[e,s]=(0,c.useState)(""),[t,a]=(0,c.useState)(1),{data:u,error:x,isLoading:h,mutate:m}=(0,r.default)(["/v1/jobs",t,e],([,e,s])=>i.v1.listJobsV1JobsGet({page:e,status:s})),[p,b]=(0,c.useState)(Date.now()/1e3),[j,g]=(0,c.useState)(null),[N,y]=(0,c.useState)({}),[v,f]=(0,c.useState)({});return(0,l.jsxs)("div",{children:[l.jsx(d.Z,{}),(0,l.jsxs)("main",{className:"container py-6",children:[l.jsx("div",{className:"flex items-center gap-2 mb-3",children:l.jsx("h2",{className:"text-xl font-semibold",children:"Jobs"})}),(0,l.jsxs)("div",{className:"card p-4 mb-4 flex items-center gap-2 flex-wrap",children:[l.jsx("label",{className:"text-gray-700",children:"Status: "}),(0,l.jsxs)("select",{className:"input",value:e,onChange:e=>s(e.target.value),children:[l.jsx("option",{value:"",children:"All"}),l.jsx("option",{value:"queued",children:"Queued"}),l.jsx("option",{value:"in_progress",children:"In Progress"}),l.jsx("option",{value:"done",children:"Done"}),l.jsx("option",{value:"failed",children:"Failed"}),l.jsx("option",{value:"dead",children:"Dead"})]}),l.jsx("button",{className:"btn",onClick:()=>m(),children:"Filter"}),l.jsx("button",{className:"btn",onClick:function(){s(""),a(1),m()},children:"Clear"}),l.jsx("button",{className:"btn",onClick:()=>{s("failed,dead"),a(1),m()},children:"Failed/Dead"}),l.jsx("div",{className:"grow"}),l.jsx("button",{className:"btn",onClick:async()=>{try{await i.v1.retryAllJobsV1JobsRetryAllPost({requestBody:{status:["failed","dead"]}}),g({kind:"success",message:"Requeued all failed/dead jobs"}),m()}catch(e){g({kind:"error",message:e.message||String(e)})}},children:"Retry All Failed/Dead"})]}),j&&l.jsx("div",{className:"mb-3",children:l.jsx(n.Z,{kind:j.kind,message:j.message,onClose:()=>g(null)})}),h&&l.jsx("p",{className:"text-gray-600",children:"Loading..."}),x&&l.jsx(n.Z,{kind:"error",message:String(x)}),u&&(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"card p-0 overflow-hidden",children:(0,l.jsxs)("table",{className:"table",children:[l.jsx("thead",{className:"bg-gray-100",children:(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"th",scope:"col",children:"ID"}),l.jsx("th",{className:"th",scope:"col",children:"Type"}),l.jsx("th",{className:"th",scope:"col",children:"Status"}),l.jsx("th",{className:"th",scope:"col",children:"Attempts"}),l.jsx("th",{className:"th",scope:"col",children:"Last Error"}),l.jsx("th",{className:"th",scope:"col",children:"Actions"})]})}),l.jsx("tbody",{children:u.items.map(e=>(0,l.jsxs)(o().Fragment,{children:[(0,l.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[l.jsx("td",{className:"td",children:e.id}),l.jsx("td",{className:"td",children:e.type}),(0,l.jsxs)("td",{className:"td",children:[e.status,"publish"===e.type&&e.details?.deduped===!0&&l.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded bg-yellow-100 text-yellow-800",children:"deduped"}),"rss_poll"===e.type&&e.details?.published!=null&&(0,l.jsxs)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded bg-green-100 text-green-800",children:[e.details.published,"/",e.details.total]})]}),l.jsx("td",{className:"td",children:e.attempts}),(0,l.jsxs)("td",{className:"td",children:[e.last_error||"","queued"===e.status&&e.available_at&&e.available_at>p&&(0,l.jsxs)("span",{className:"ml-2 text-gray-600",children:["retry in ",Math.max(0,Math.floor(e.available_at-p)),"s"]})]}),(0,l.jsxs)("td",{className:"td flex gap-2",children:[l.jsx("button",{className:"btn",onClick:async()=>{let s={...N,[e.id]:!N[e.id]};if(y(s),!v[e.id])try{let s=await i.v1.getJobV1JobsJobIdGet({jobId:e.id});f({...v,[e.id]:s})}catch(e){}},children:"Details"}),("failed"===e.status||"dead"===e.status)&&l.jsx("button",{className:"btn",onClick:async()=>{try{await i.v1.retryJobV1JobsJobIdRetryPost({jobId:e.id}),g({kind:"success",message:"Job requeued"}),m()}catch(e){g({kind:"error",message:`Retry failed: ${e.message||e}`})}},children:"Retry"})]})]},e.id),N[e.id]&&l.jsx("tr",{className:"bg-gray-50",children:l.jsx("td",{className:"td",colSpan:6,children:(0,l.jsxs)("div",{className:"p-3",children:[l.jsx("h4",{className:"font-semibold mb-2",children:"Details"}),l.jsx("pre",{className:"text-sm bg-white p-3 rounded border overflow-auto",children:JSON.stringify(v[e.id]?.details??e.details??{},null,2)}),l.jsx("h4",{className:"font-semibold my-2",children:"Payload"}),l.jsx("pre",{className:"text-sm bg-white p-3 rounded border overflow-auto",children:JSON.stringify(v[e.id]?.payload??e.payload??{},null,2)})]})})},`${e.id}-details`)]},e.id))})]})}),(0,l.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[l.jsx("button",{className:"btn",disabled:t<=1,onClick:()=>a(t-1),children:"Prev"}),(0,l.jsxs)("span",{className:"text-gray-700",children:["Page ",t," / ",u.totalPages]}),l.jsx("button",{className:"btn",disabled:!u.hasNext,onClick:()=>a(t+1),children:"Next"})]})]})]})]})}[r,d,i]=u.then?(await u)():u,a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},5526:e=>{e.exports=import("next-auth/react")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var s=require("../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[899,910,902],()=>t(8030));module.exports=a})();