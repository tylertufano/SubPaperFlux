(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[664],{2003:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/bookmarks",function(){return s(5564)}])},7435:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(5893);function l(e){let{kind:t="info",message:s,onClose:l}=e,n="success"===t?"green":"warning"===t?"yellow":"error"===t?"red":"blue";return(0,a.jsxs)("div",{className:"rounded-md border px-3 py-2 bg-".concat(n,"-50 border-").concat(n,"-200 text-").concat(n,"-800 flex items-start justify-between gap-2"),children:[(0,a.jsx)("div",{children:s}),l&&(0,a.jsx)("button",{className:"text-".concat(n,"-800"),onClick:l,children:"\xd7"})]})}},5564:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(5893),l=s(1758),n=s(4985),i=s(5451),c=s(7294),r=s(7435);function o(){var e,t,s,o;let[d,u]=(0,c.useState)(1),[m,h]=(0,c.useState)(""),[x,p]=(0,c.useState)([]),[j,v]=(0,c.useState)(""),[b,g]=(0,c.useState)(""),[f,k]=(0,c.useState)(""),[N,y]=(0,c.useState)(""),[S,C]=(0,c.useState)(!1);function _(e){if(e)return e.endsWith("Z")?e:e+":00Z"}let{data:w,error:E,isLoading:O,mutate:V}=(0,l.ZP)(["/v1/bookmarks",d,m,b,f,N,S],e=>{let[,t,s,a,l,n,c]=e;return i.v1.listBookmarksV1BookmarksGet({page:t,search:s,feedId:a||void 0,since:_(l),until:_(n),fuzzy:c||void 0})}),{data:B}=(0,l.ZP)(["/v1/feeds"],()=>i.v1.listFeedsV1V1FeedsGet({})),P=Array.isArray(B)?B:null!==(o=null==B?void 0:B.items)&&void 0!==o?o:[],[Z,z]=(0,c.useState)(null),[D,L]=(0,c.useState)({});async function U(){let e=Object.entries(D).filter(e=>{let[,t]=e;return t}).map(e=>{let[t]=e;return t});if(e.length&&confirm("Delete ".concat(e.length," bookmarks? This also deletes in Instapaper.")))try{await i.v1.bulkDeleteBookmarksV1BookmarksBulkDeletePost({requestBody:{ids:e,delete_remote:!0}}),z({kind:"success",message:"Deleted ".concat(e.length," bookmarks.")}),L({}),V()}catch(e){z({kind:"error",message:"Delete failed: ".concat(e.message||e)})}}function F(e){var t;let s=(null!==(t=null==w?void 0:w.items)&&void 0!==t?t:[]).filter(e=>D[e.id]);if(s.length){if("json"===e){let e=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="bookmarks.json",t.click()}else{let e=["id","instapaper_bookmark_id","title","url","content_location","feed_id","published_at"],t=new Blob([[e.join(",")].concat(s.map(t=>e.map(e=>{var s;return JSON.stringify(null!==(s=t[e])&&void 0!==s?s:"")}).join(","))).join("\n")],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="bookmarks.csv",a.click()}}}return(0,c.useEffect)(()=>{let e=localStorage.getItem("bookmarkViews");e&&p(JSON.parse(e))},[]),(0,a.jsxs)("div",{children:[(0,a.jsx)(n.Z,{}),(0,a.jsxs)("main",{className:"container py-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Bookmarks"})}),(0,a.jsxs)("div",{className:"card p-4 mb-4 grid grid-cols-1 md:grid-cols-7 gap-2 items-center",children:[(0,a.jsx)("input",{className:"input",value:m,onChange:e=>h(e.target.value),placeholder:"Search"}),(0,a.jsxs)("select",{className:"input",value:b,onChange:e=>g(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"All Feeds"}),P.map(e=>(0,a.jsx)("option",{value:e.id,children:e.url},e.id))]}),(0,a.jsx)("input",{className:"input",type:"datetime-local",value:f,onChange:e=>k(e.target.value),title:"Since"}),(0,a.jsx)("input",{className:"input",type:"datetime-local",value:N,onChange:e=>y(e.target.value),title:"Until"}),(0,a.jsxs)("label",{className:"inline-flex items-center gap-2 text-gray-700",children:[(0,a.jsx)("input",{type:"checkbox",checked:S,onChange:e=>C(e.target.checked)})," Fuzzy"]}),(0,a.jsx)("button",{className:"btn",onClick:()=>{u(1),V()},children:"Search"}),(0,a.jsx)("button",{className:"btn",onClick:function(){h(""),g(""),k(""),y(""),C(!1),u(1),V()},children:"Clear"}),(0,a.jsxs)("select",{className:"input md:col-span-2",onChange:e=>{let t=x.find(t=>t.name===e.target.value);t&&(h(t.search||""),g(t.feed_id||""),k(t.since||""),y(t.until||""),C(!!t.fuzzy),u(1),V())},defaultValue:"",children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Saved Views"}),x.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{className:"input",placeholder:"Save as...",value:j,onChange:e=>v(e.target.value)}),(0,a.jsx)("button",{className:"btn",onClick:function(){if(!j.trim())return;let e=[...x.filter(e=>e.name!==j.trim()),{name:j.trim(),search:m,feed_id:b||void 0,since:f||void 0,until:N||void 0,fuzzy:S}];p(e),localStorage.setItem("bookmarkViews",JSON.stringify(e)),v("")},children:"Save View"})]})]}),Z&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)(r.Z,{kind:Z.kind,message:Z.message,onClose:()=>z(null)})}),O&&(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."}),E&&(0,a.jsx)(r.Z,{kind:"error",message:String(E)}),w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"card p-0 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-3 flex items-center gap-2",children:[(0,a.jsx)("button",{className:"btn",disabled:!(null===(e=w.items)||void 0===e?void 0:e.length),onClick:U,children:"Delete Selected"}),(0,a.jsx)("button",{className:"btn",disabled:!(null===(t=w.items)||void 0===t?void 0:t.length),onClick:()=>F("json"),children:"Export JSON"}),(0,a.jsx)("button",{className:"btn",disabled:!(null===(s=w.items)||void 0===s?void 0:s.length),onClick:()=>F("csv"),children:"Export CSV"})]}),(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"th",scope:"col",children:(0,a.jsx)("input",{"aria-label":"Select all",type:"checkbox",onChange:e=>(function(e){var t;let s={};for(let a of null!==(t=null==w?void 0:w.items)&&void 0!==t?t:[])s[a.id]=e;L(s)})(e.target.checked)})}),(0,a.jsx)("th",{className:"th",scope:"col",children:"Title"}),(0,a.jsx)("th",{className:"th",scope:"col",children:"URL"}),(0,a.jsx)("th",{className:"th",scope:"col",children:"Published"})]})}),(0,a.jsx)("tbody",{children:w.items.map(e=>(0,a.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[(0,a.jsx)("td",{className:"td",children:(0,a.jsx)("input",{type:"checkbox",checked:D[e.id]||!1,onChange:t=>{var s,a;return s=e.id,a=t.target.checked,void L(e=>({...e,[s]:a}))}})}),(0,a.jsx)("td",{className:"td",children:e.title}),(0,a.jsx)("td",{className:"td",children:(0,a.jsx)("a",{className:"text-blue-600 hover:underline",href:e.url,target:"_blank",rel:"noreferrer",children:e.url})}),(0,a.jsx)("td",{className:"td",children:e.published_at||""})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,a.jsx)("button",{className:"btn",disabled:d<=1,onClick:()=>u(d-1),children:"Prev"}),(0,a.jsxs)("span",{className:"text-gray-700",children:["Page ",d," / ",w.totalPages]}),(0,a.jsx)("button",{className:"btn",disabled:!w.hasNext,onClick:()=>u(d+1),children:"Next"})]})]})]})]})}}},function(e){e.O(0,[360,561,888,774,179],function(){return e(e.s=2003)}),_N_E=e.O()}]);