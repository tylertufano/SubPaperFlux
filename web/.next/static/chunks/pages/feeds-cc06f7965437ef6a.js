(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{9278:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/feeds",function(){return a(3221)}])},7435:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});var l=a(5893);function t(e){let{kind:s="info",message:a,onClose:t}=e,i="success"===s?"green":"warning"===s?"yellow":"error"===s?"red":"blue";return(0,l.jsxs)("div",{className:"rounded-md border px-3 py-2 bg-".concat(i,"-50 border-").concat(i,"-200 text-").concat(i,"-800 flex items-start justify-between gap-2"),children:[(0,l.jsx)("div",{children:a}),t&&(0,l.jsx)("button",{className:"text-".concat(i,"-800"),onClick:t,children:"\xd7"})]})}},3221:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return r}});var l=a(5893),t=a(1758),i=a(4985),n=a(5451),d=a(7294),c=a(7435);function r(){let{data:e,error:s,isLoading:a,mutate:r}=(0,t.ZP)(["/v1/feeds"],()=>n.v1.listFeedsV1V1FeedsGet({})),[o,u]=(0,d.useState)(""),[h,m]=(0,d.useState)("1h"),[g,x]=(0,d.useState)(""),[p,j]=(0,d.useState)(!1),[f,k]=(0,d.useState)(!1),[N,b]=(0,d.useState)(""),[v,y]=(0,d.useState)(null),[C,w]=(0,d.useState)(null),[_,F]=(0,d.useState)(null);async function P(){if(!o.trim()){y({kind:"error",message:"URL is required"});return}try{await n.IH.createFeedFeedsPost({feed:{url:o,pollFrequency:h,initialLookbackPeriod:g||void 0,isPaywalled:p,rssRequiresAuth:f,siteConfigId:N||void 0}}),u(""),x(""),b(""),j(!1),k(!1),y({kind:"success",message:"Feed created"}),r()}catch(e){y({kind:"error",message:(null==e?void 0:e.message)||String(e)})}}async function q(e){if(confirm("Delete feed?"))try{await n.IH.deleteFeedFeedsFeedIdDelete({feedId:e}),y({kind:"success",message:"Feed deleted"}),r()}catch(e){y({kind:"error",message:(null==e?void 0:e.message)||String(e)})}}async function S(e){var s,a;w(e.id),F({url:e.url||"",pollFrequency:e.poll_frequency||e.pollFrequency||"1h",initialLookbackPeriod:e.initial_lookback_period||e.initialLookbackPeriod||"",isPaywalled:!!(null!==(s=e.is_paywalled)&&void 0!==s?s:e.isPaywalled),rssRequiresAuth:!!(null!==(a=e.rss_requires_auth)&&void 0!==a?a:e.rssRequiresAuth),siteConfigId:e.site_config_id||e.siteConfigId||""})}function I(){w(null),F(null)}async function L(e){try{await n.IH.updateFeedFeedsFeedIdPut({feedId:e,feed:{url:_.url,pollFrequency:_.pollFrequency,initialLookbackPeriod:_.initialLookbackPeriod||void 0,isPaywalled:!!_.isPaywalled,rssRequiresAuth:!!_.rssRequiresAuth,siteConfigId:_.siteConfigId||void 0}}),y({kind:"success",message:"Feed updated"}),w(null),F(null),r()}catch(e){y({kind:"error",message:(null==e?void 0:e.message)||String(e)})}}return(0,l.jsxs)("div",{children:[(0,l.jsx)(i.Z,{}),(0,l.jsxs)("main",{className:"container py-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Feeds"}),v&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)(c.Z,{kind:v.kind,message:v.message,onClose:()=>y(null)})}),(0,l.jsxs)("div",{className:"card p-4 mb-4 grid grid-cols-1 md:grid-cols-3 gap-2",children:[(0,l.jsx)("h3",{className:"font-semibold md:col-span-3",children:"Create Feed"}),(0,l.jsx)("input",{className:"input md:col-span-2",placeholder:"Feed URL",value:o,onChange:e=>u(e.target.value)}),(0,l.jsx)("input",{className:"input",placeholder:"Poll frequency (e.g., 1h)",value:h,onChange:e=>m(e.target.value)}),(0,l.jsx)("input",{className:"input",placeholder:"Initial lookback (e.g., 7d)",value:g,onChange:e=>x(e.target.value)}),(0,l.jsx)("input",{className:"input",placeholder:"Site Config ID (optional)",value:N,onChange:e=>b(e.target.value)}),(0,l.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:p,onChange:e=>j(e.target.checked)})," Paywalled"]}),(0,l.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:f,onChange:e=>k(e.target.checked)})," RSS requires auth"]}),(0,l.jsx)("button",{className:"btn",onClick:P,children:"Create"})]}),a&&(0,l.jsx)("p",{className:"text-gray-600",children:"Loading..."}),s&&(0,l.jsx)(c.Z,{kind:"error",message:String(s)}),e&&(0,l.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,l.jsxs)("table",{className:"table",children:[(0,l.jsx)("thead",{className:"bg-gray-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"th",children:"URL"}),(0,l.jsx)("th",{className:"th",children:"Poll"}),(0,l.jsx)("th",{className:"th",children:"Lookback"}),(0,l.jsx)("th",{className:"th",children:"Paywalled"}),(0,l.jsx)("th",{className:"th",children:"RSS Auth"}),(0,l.jsx)("th",{className:"th",children:"Site Config"}),(0,l.jsx)("th",{className:"th",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:(e.items||e).map(e=>{var s,a;return(0,l.jsx)("tr",{className:"odd:bg-white even:bg-gray-50",children:C===e.id?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{className:"td",children:(0,l.jsx)("input",{className:"input w-full",value:_.url,onChange:e=>F({..._,url:e.target.value})})}),(0,l.jsx)("td",{className:"td",children:(0,l.jsx)("input",{className:"input w-full",value:_.pollFrequency,onChange:e=>F({..._,pollFrequency:e.target.value})})}),(0,l.jsx)("td",{className:"td",children:(0,l.jsx)("input",{className:"input w-full",value:_.initialLookbackPeriod,onChange:e=>F({..._,initialLookbackPeriod:e.target.value})})}),(0,l.jsx)("td",{className:"td",children:(0,l.jsx)("input",{type:"checkbox",checked:_.isPaywalled,onChange:e=>F({..._,isPaywalled:e.target.checked})})}),(0,l.jsx)("td",{className:"td",children:(0,l.jsx)("input",{type:"checkbox",checked:_.rssRequiresAuth,onChange:e=>F({..._,rssRequiresAuth:e.target.checked})})}),(0,l.jsx)("td",{className:"td",children:(0,l.jsx)("input",{className:"input w-full",value:_.siteConfigId,onChange:e=>F({..._,siteConfigId:e.target.value})})}),(0,l.jsxs)("td",{className:"td flex gap-2",children:[(0,l.jsx)("button",{className:"btn",onClick:()=>L(e.id),children:"Save"}),(0,l.jsx)("button",{className:"btn",onClick:I,children:"Cancel"})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{className:"td",children:e.url}),(0,l.jsx)("td",{className:"td",children:e.poll_frequency||e.pollFrequency}),(0,l.jsx)("td",{className:"td",children:e.initial_lookback_period||e.initialLookbackPeriod||""}),(0,l.jsx)("td",{className:"td",children:String(null!==(s=e.is_paywalled)&&void 0!==s?s:e.isPaywalled)}),(0,l.jsx)("td",{className:"td",children:String(null!==(a=e.rss_requires_auth)&&void 0!==a?a:e.rssRequiresAuth)}),(0,l.jsx)("td",{className:"td",children:e.site_config_id||e.siteConfigId||""}),(0,l.jsxs)("td",{className:"td flex gap-2",children:[(0,l.jsx)("button",{className:"btn",onClick:()=>S(e),children:"Edit"}),(0,l.jsx)("button",{className:"btn",onClick:()=>q(e.id),children:"Delete"})]})]})},e.id)})})]})})]})]})}}},function(e){e.O(0,[360,561,888,774,179],function(){return e(e.s=9278)}),_N_E=e.O()}]);