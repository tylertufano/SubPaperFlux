(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[749],{3065:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/credentials",function(){return s(7619)}])},7435:function(e,n,s){"use strict";s.d(n,{Z:function(){return r}});var t=s(5893);function r(e){let{kind:n="info",message:s,onClose:r}=e,i="success"===n?"green":"warning"===n?"yellow":"error"===n?"red":"blue";return(0,t.jsxs)("div",{className:"rounded-md border px-3 py-2 bg-".concat(i,"-50 border-").concat(i,"-200 text-").concat(i,"-800 flex items-start justify-between gap-2"),children:[(0,t.jsx)("div",{children:s}),r&&(0,t.jsx)("button",{className:"text-".concat(i,"-800"),onClick:r,children:"\xd7"})]})}},1789:function(e,n,s){"use strict";function t(e){try{return new URL(e),!0}catch(e){return!1}}function r(e){try{return{ok:!0,data:JSON.parse(e)}}catch(e){return{ok:!1,error:(null==e?void 0:e.message)||"Invalid JSON"}}}function i(e,n){if(!n||"object"!=typeof n)return"Data must be a JSON object";if("site_login"===e)return n.username?n.password?null:"password is required":"username is required";if("miniflux"===e)return n.miniflux_url&&t(n.miniflux_url)?n.api_key?null:"api_key is required":"miniflux_url is invalid";if("instapaper"===e)return n.oauth_token?n.oauth_token_secret?null:"oauth_token_secret is required":"oauth_token is required";if("instapaper_app"===e){if(!n.consumer_key)return"consumer_key is required";if(!n.consumer_secret)return"consumer_secret is required"}return null}function a(e){var n,s,r,i;return(null===(n=e.name)||void 0===n?void 0:n.trim())?e.site_url&&t(e.site_url)?(null===(s=e.username_selector)||void 0===s?void 0:s.trim())?(null===(r=e.password_selector)||void 0===r?void 0:r.trim())?(null===(i=e.login_button_selector)||void 0===i?void 0:i.trim())?null:"Login button selector is required":"Password selector is required":"Username selector is required":"Site URL is invalid":"Name is required"}s.d(n,{Et:function(){return i},kq:function(){return a},rM:function(){return r}})},7619:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return o}});var t=s(5893),r=s(1758),i=s(4985),a=s(5451),l=s(7294),c=s(7435),d=s(1789);function o(){var e;let{data:n,error:s,isLoading:o,mutate:u}=(0,r.ZP)(["/v1/credentials"],()=>a.v1.listCredentialsV1V1CredentialsGet({})),[m,h]=(0,l.useState)("site_login"),[x,p]=(0,l.useState)(!1),[f,g]=(0,l.useState)('{\n  "username": "",\n  "password": ""\n}'),[j,_]=(0,l.useState)(null);async function k(e){try{if("instapaper"===e.kind){let n=await a.v1.testInstapaperV1IntegrationsInstapaperTestPost({requestBody:{credential_id:e.id}});_({kind:n.ok?"success":"error",message:"Instapaper: ".concat(JSON.stringify(n))})}else if("miniflux"===e.kind){let n=await a.v1.testMinifluxV1IntegrationsMinifluxTestPost({requestBody:{credential_id:e.id}});_({kind:n.ok?"success":"error",message:"Miniflux: ".concat(JSON.stringify(n))})}}catch(e){_({kind:"error",message:e.message||String(e)})}}async function v(){let e=(0,d.rM)(f);if(!e.ok){_({kind:"error",message:e.error});return}let n=(0,d.Et)(m,e.data);if(n){_({kind:"error",message:n});return}try{await a.fV.createCredentialCredentialsPost({credential:{kind:m,data:e.data,ownerUserId:x?null:void 0}}),g(""),_({kind:"success",message:"Credential created"}),u()}catch(e){_({kind:"error",message:e.message||String(e)})}}async function N(e){if(confirm("Delete credential?"))try{await a.fV.deleteCredentialCredentialsCredIdDelete({credId:e}),_({kind:"success",message:"Credential deleted"}),u()}catch(e){_({kind:"error",message:e.message||String(e)})}}return(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Z,{}),(0,t.jsxs)("main",{className:"container py-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Credentials"}),o&&(0,t.jsx)("p",{className:"text-gray-600",children:"Loading..."}),s&&(0,t.jsx)("p",{className:"text-red-600",children:String(s)}),j&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)(c.Z,{kind:j.kind,message:j.message,onClose:()=>_(null)})}),n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"card p-4 mb-4 flex flex-col gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Create Credential"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("label",{children:"Kind:"}),(0,t.jsxs)("select",{className:"input",value:m,onChange:e=>h(e.target.value),children:[(0,t.jsx)("option",{value:"site_login",children:"site_login"}),(0,t.jsx)("option",{value:"miniflux",children:"miniflux"}),(0,t.jsx)("option",{value:"instapaper",children:"instapaper"}),(0,t.jsx)("option",{value:"instapaper_app",children:"instapaper_app (admin/global)"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:x,onChange:e=>p(e.target.checked)})," Global (admin)"]})]}),(0,t.jsx)("textarea",{className:"input min-h-[120px]",value:f,onChange:e=>g(e.target.value),placeholder:"JSON data"}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{className:"btn",onClick:v,children:"Create"})})]}),(0,t.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"th",scope:"col",children:"ID"}),(0,t.jsx)("th",{className:"th",scope:"col",children:"Kind"}),(0,t.jsx)("th",{className:"th",scope:"col",children:"Scope"}),(0,t.jsx)("th",{className:"th",scope:"col",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:(null!==(e=n.items)&&void 0!==e?e:n).map(e=>(0,t.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[(0,t.jsx)("td",{className:"td",children:e.id}),(0,t.jsx)("td",{className:"td",children:e.kind}),(0,t.jsx)("td",{className:"td",children:e.ownerUserId?"User":"Global"}),(0,t.jsxs)("td",{className:"td flex gap-2",children:[("instapaper"===e.kind||"miniflux"===e.kind)&&(0,t.jsx)("button",{className:"btn",onClick:()=>k(e),children:"Test"}),(0,t.jsx)("button",{className:"btn",onClick:()=>N(e.id),children:"Delete"})]})]},e.id))})]})})]})]})]})}}},function(e){e.O(0,[360,561,888,774,179],function(){return e(e.s=3065)}),_N_E=e.O()}]);