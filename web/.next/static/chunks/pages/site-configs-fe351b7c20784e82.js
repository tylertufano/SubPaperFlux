(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[753],{8607:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/site-configs",function(){return t(3859)}])},7435:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var n=t(5893);function r(e){let{kind:s="info",message:t,onClose:r}=e,i="success"===s?"green":"warning"===s?"yellow":"error"===s?"red":"blue";return(0,n.jsxs)("div",{className:"rounded-md border px-3 py-2 bg-".concat(i,"-50 border-").concat(i,"-200 text-").concat(i,"-800 flex items-start justify-between gap-2"),children:[(0,n.jsx)("div",{children:t}),r&&(0,n.jsx)("button",{className:"text-".concat(i,"-800"),onClick:r,children:"\xd7"})]})}},1789:function(e,s,t){"use strict";function n(e){try{return new URL(e),!0}catch(e){return!1}}function r(e){try{return{ok:!0,data:JSON.parse(e)}}catch(e){return{ok:!1,error:(null==e?void 0:e.message)||"Invalid JSON"}}}function i(e,s){if(!s||"object"!=typeof s)return"Data must be a JSON object";if("site_login"===e)return s.username?s.password?null:"password is required":"username is required";if("miniflux"===e)return s.miniflux_url&&n(s.miniflux_url)?s.api_key?null:"api_key is required":"miniflux_url is invalid";if("instapaper"===e)return s.oauth_token?s.oauth_token_secret?null:"oauth_token_secret is required":"oauth_token is required";if("instapaper_app"===e){if(!s.consumer_key)return"consumer_key is required";if(!s.consumer_secret)return"consumer_secret is required"}return null}function o(e){var s,t,r,i;return(null===(s=e.name)||void 0===s?void 0:s.trim())?e.site_url&&n(e.site_url)?(null===(t=e.username_selector)||void 0===t?void 0:t.trim())?(null===(r=e.password_selector)||void 0===r?void 0:r.trim())?(null===(i=e.login_button_selector)||void 0===i?void 0:i.trim())?null:"Login button selector is required":"Password selector is required":"Username selector is required":"Site URL is invalid":"Name is required"}t.d(s,{Et:function(){return i},kq:function(){return o},rM:function(){return r}})},3859:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var n=t(5893),r=t(1758),i=t(4985),o=t(5451),a=t(7294),l=t(7435),c=t(1789);function u(){let{data:e,error:s,isLoading:t,mutate:u}=(0,r.ZP)(["/v1/site-configs"],()=>o.v1.listSiteConfigsV1V1SiteConfigsGet({})),[d,m]=(0,a.useState)({name:"",site_url:"",username_selector:"",password_selector:"",login_button_selector:"",cookies_to_store:""}),[g,h]=(0,a.useState)(!1),[_,f]=(0,a.useState)(null);async function p(){let e={...d,cookies_to_store:d.cookies_to_store.split(",").map(e=>e.trim()).filter(Boolean)};try{let s=(0,c.kq)(e);if(s){f({kind:"error",message:s});return}await o.RX.createSiteConfigSiteConfigsPost({siteConfig:{...e,ownerUserId:g?null:void 0}}),m({name:"",site_url:"",username_selector:"",password_selector:"",login_button_selector:"",cookies_to_store:""}),h(!1),f({kind:"success",message:"Site config created"}),u()}catch(e){f({kind:"error",message:e.message||String(e)})}}async function x(e){if(confirm("Delete site config?"))try{await o.RX.deleteSiteConfigSiteConfigsConfigIdDelete({configId:e}),f({kind:"success",message:"Site config deleted"}),u()}catch(e){f({kind:"error",message:e.message||String(e)})}}return(0,n.jsxs)("div",{children:[(0,n.jsx)(i.Z,{}),(0,n.jsxs)("main",{className:"container py-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Site Configs"}),_&&(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(l.Z,{kind:_.kind,message:_.message,onClose:()=>f(null)})}),t&&(0,n.jsx)("p",{className:"text-gray-600",children:"Loading..."}),s&&(0,n.jsx)(l.Z,{kind:"error",message:String(s)}),(0,n.jsxs)("div",{className:"card p-4 mb-4 grid grid-cols-1 md:grid-cols-2 gap-2",children:[(0,n.jsx)("h3",{className:"font-semibold md:col-span-2",children:"Create Site Config"}),(0,n.jsx)("input",{className:"input",placeholder:"Name",value:d.name,onChange:e=>m({...d,name:e.target.value})}),(0,n.jsx)("input",{className:"input",placeholder:"Site URL",value:d.site_url,onChange:e=>m({...d,site_url:e.target.value})}),(0,n.jsx)("input",{className:"input",placeholder:"Username selector",value:d.username_selector,onChange:e=>m({...d,username_selector:e.target.value})}),(0,n.jsx)("input",{className:"input",placeholder:"Password selector",value:d.password_selector,onChange:e=>m({...d,password_selector:e.target.value})}),(0,n.jsx)("input",{className:"input",placeholder:"Login button selector",value:d.login_button_selector,onChange:e=>m({...d,login_button_selector:e.target.value})}),(0,n.jsx)("input",{className:"input md:col-span-2",placeholder:"Cookies to store (comma-separated)",value:d.cookies_to_store,onChange:e=>m({...d,cookies_to_store:e.target.value})}),(0,n.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:g,onChange:e=>h(e.target.checked)})," Global (admin)"]}),(0,n.jsx)("button",{className:"btn",onClick:p,children:"Create"})]}),e&&(0,n.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{className:"bg-gray-100",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"th",scope:"col",children:"Name"}),(0,n.jsx)("th",{className:"th",scope:"col",children:"URL"}),(0,n.jsx)("th",{className:"th",scope:"col",children:"Scope"}),(0,n.jsx)("th",{className:"th",scope:"col",children:"Actions"})]})}),(0,n.jsx)("tbody",{children:(e.items||e).map(e=>(0,n.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[(0,n.jsx)("td",{className:"td",children:e.name}),(0,n.jsx)("td",{className:"td",children:e.site_url}),(0,n.jsx)("td",{className:"td",children:e.owner_user_id?"User":"Global"}),(0,n.jsxs)("td",{className:"td flex gap-2",children:[(0,n.jsx)("button",{className:"btn",onClick:async()=>{try{let s=await o.v1.testSiteConfigV1SiteConfigsConfigIdTestPost({configId:e.id});f({kind:s.ok?"success":"error",message:"Test: ".concat(JSON.stringify(s))})}catch(e){f({kind:"error",message:e.message||String(e)})}},children:"Test Login"}),(0,n.jsx)("button",{className:"btn",onClick:()=>x(e.id),children:"Delete"})]})]},e.id))})]})})]})]})}}},function(e){e.O(0,[360,561,888,774,179],function(){return e(e.s=8607)}),_N_E=e.O()}]);